# Telegram Timer Bot

–ü—Ä–æ—Å—Ç–æ–π Telegram –±–æ—Ç –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–∞–π–º–µ—Ä–æ–≤, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ —á–∏—Å—Ç–æ–º Go –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è Telegram Bot API.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- `/timer Xs` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä –Ω–∞ X —Å–µ–∫—É–Ω–¥
- `/timer Xm` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä –Ω–∞ X –º–∏–Ω—É—Ç
- `/cancel` - –æ—Ç–º–µ–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∞–π–º–µ—Ä

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –ß–∏—Å—Ç—ã–π Go –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
- –ü—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å Telegram Bot API —á–µ—Ä–µ–∑ HTTP
- Long polling –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- In-memory —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–≤ —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
- Graceful shutdown —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–∏–≥–Ω–∞–ª–æ–≤
- Retry logic —Å exponential backoff
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### Long polling –≤–µ—Ä—Å–∏—è (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Go 1.21+
2. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å —Ç–æ–∫–µ–Ω–æ–º:

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à BOT_TOKEN
```

4. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
make build
./bin/tg-timer
```

### Webhook –≤–µ—Ä—Å–∏—è (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

**–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å ngrok:**

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok: brew install ngrok
# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok: ngrok http 8443
# 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTTPS URL –∏–∑ ngrok

cp .env.webhook.example .env.webhook
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.webhook:
# BOT_TOKEN=your_token
# WEBHOOK_URL=https://your-ngrok-url.ngrok.io/webhook

make webhook-local
```

**–ü—Ä–æ–¥–∞–∫—à–µ–Ω —Å Docker:**

```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Å WEBHOOK_URL (HTTPS)
make docker-build
make docker-run
```

**–†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ webhook:**

```bash
export BOT_TOKEN="your_token"
export WEBHOOK_URL="https://your-domain.com/webhook"
export PORT="8443"

make webhook-build
./bin/tg-timer-webhook
```

**–°–±–æ—Ä–∫–∞ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏–π:**

```bash
make build-all  # –°–æ–±–µ—Ä–µ—Ç bin/tg-timer –∏ bin/tg-timer-webhook
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Makefile:

- `make build` - —Å–æ–±—Ä–∞—Ç—å long polling –≤–µ—Ä—Å–∏—é
- `make webhook-build` - —Å–æ–±—Ä–∞—Ç—å webhook –≤–µ—Ä—Å–∏—é
- `make build-all` - —Å–æ–±—Ä–∞—Ç—å –æ–±–µ –≤–µ—Ä—Å–∏–∏ —Å—Ä–∞–∑—É
- `make run` - –∑–∞–ø—É—Å—Ç–∏—Ç—å long polling –≤–µ—Ä—Å–∏—é
- `make webhook` - –∑–∞–ø—É—Å—Ç–∏—Ç—å webhook –≤–µ—Ä—Å–∏—é
- `make webhook-local` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å ngrok
- `make docker-build` - —Å–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑
- `make docker-run` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ docker-compose

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–ê–ñ–ù–û: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ —Ç–æ–∫–µ–Ω —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º, –≤–∫–ª—é—á–∞—è AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤**

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:

1. **–õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

   ```bash
   export BOT_TOKEN="your_token"
   ./bin/tg-timer
   ```

2. **–õ–æ–∫–∞–ª—å–Ω—ã–π .env —Ñ–∞–π–ª (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):**

   ```bash
   cp .env.example .env
   # .env –≤ .gitignore, –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   ```

3. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–ø—Ä–æ–¥–∞–∫—à–µ–Ω):**
   ```bash
   # systemd, Docker, Kubernetes secrets
   ```

### ‚ùå –û–ø–∞—Å–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã (–ù–ò–ö–û–ì–î–ê –Ω–µ –¥–µ–ª–∞–π—Ç–µ):

- –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –∫–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–∫–µ–Ω –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- –ö–æ–º–º–∏—Ç–∏—Ç—å .env —Ñ–∞–π–ª—ã
- –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

üìñ **–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** —Å–º. [SECURITY.md](SECURITY.md)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É Go layout:

- `cmd/tg-timer/` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `internal/bot/` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–º–µ–Ω–µ–¥–∂–µ—Ä —Ç–∞–π–º–µ—Ä–æ–≤, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥)
- `pkg/telegram/` - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–ª–∏–µ–Ω—Ç Telegram Bot API
- `bin/` - —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã
- `Makefile` - –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `go.mod` - –º–æ–¥—É–ª—å Go –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–∞–∫—Å–∏–º—É–º –æ–¥–∏–Ω —Ç–∞–π–º–µ—Ä –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ç–∞–π–º–µ—Ä–∞ - 24 —á–∞—Å–∞
- –í—Å–µ —Ç–∞–π–º–µ—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (–ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Ç–µ—Ä—è—é—Ç—Å—è)
